{"source":2,"revision":20,"description":null,"createdBy":{"displayName":"Pierlo Upitup","url":"https://app.vssps.visualstudio.com/A98148d1e-0359-4d91-8810-1683762054ef/_apis/Identities/5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","_links":{"avatar":{"href":"https://dev.azure.com/pierluigi-github/_apis/GraphProfile/MemberAvatars/msa.NWUwZWEwYzctNzFkNy03ZWExLWExMmEtOTQ0Y2IxMzE4ZDhj"}},"id":"5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","uniqueName":"pierlooqup@gmail.com","imageUrl":"https://dev.azure.com/pierluigi-github/_api/_common/identityImage?id=5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","descriptor":"msa.NWUwZWEwYzctNzFkNy03ZWExLWExMmEtOTQ0Y2IxMzE4ZDhj"},"createdOn":"2019-01-03T12:52:04.520Z","modifiedBy":{"displayName":"Pierlo Upitup","url":"https://app.vssps.visualstudio.com/A98148d1e-0359-4d91-8810-1683762054ef/_apis/Identities/5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","_links":{"avatar":{"href":"https://dev.azure.com/pierluigi-github/_apis/GraphProfile/MemberAvatars/msa.NWUwZWEwYzctNzFkNy03ZWExLWExMmEtOTQ0Y2IxMzE4ZDhj"}},"id":"5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","uniqueName":"pierlooqup@gmail.com","imageUrl":"https://dev.azure.com/pierluigi-github/_api/_common/identityImage?id=5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","descriptor":"msa.NWUwZWEwYzctNzFkNy03ZWExLWExMmEtOTQ0Y2IxMzE4ZDhj"},"modifiedOn":"2019-01-03T14:38:57.260Z","isDeleted":false,"variables":{},"variableGroups":[],"environments":[{"id":1,"name":"Inject new tag in dev","rank":1,"owner":{"displayName":"Pierlo Upitup","url":"https://app.vssps.visualstudio.com/A98148d1e-0359-4d91-8810-1683762054ef/_apis/Identities/5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","_links":{"avatar":{"href":"https://dev.azure.com/pierluigi-github/_apis/GraphProfile/MemberAvatars/msa.NWUwZWEwYzctNzFkNy03ZWExLWExMmEtOTQ0Y2IxMzE4ZDhj"}},"id":"5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","uniqueName":"pierlooqup@gmail.com","imageUrl":"https://dev.azure.com/pierluigi-github/_api/_common/identityImage?id=5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","descriptor":"msa.NWUwZWEwYzctNzFkNy03ZWExLWExMmEtOTQ0Y2IxMzE4ZDhj"},"variables":{},"variableGroups":[],"preDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":1}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":1}},"deployStep":{"id":2},"postDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":3}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":2}},"deployPhases":[{"deploymentInput":{"parallelExecution":{"parallelExecutionType":0},"skipArtifactsDownload":false,"artifactsDownloadInput":{"downloadInputs":[]},"queueId":12,"demands":[],"enableAccessToken":false,"timeoutInMinutes":0,"jobCancelTimeoutInMinutes":1,"condition":"succeeded()","overrideInputs":{}},"rank":1,"phaseType":1,"name":"Agent job","refName":null,"workflowTasks":[{"environment":{},"taskId":"e213ff0f-5d5c-4791-802d-52ea3e7be1f1","version":"2.*","name":"export var","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"$imagetag = Get-Content -Path  _githubpartners.blueprint\\drop\\imagetag\n\nWrite-Output(\"##vso[task.setvariable variable=imagetag;]$imagetag\")","errorActionPreference":"stop","failOnStderr":"false","ignoreLASTEXITCODE":"false","pwsh":"false","workingDirectory":""}},{"environment":{},"taskId":"cbc316a2-586f-4def-be79-488a1f503564","version":"1.*","name":"kubectl set","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"connectionType":"Azure Resource Manager","kubernetesServiceEndpoint":"","azureSubscriptionEndpoint":"0e835040-6b34-4c78-84b2-c2a01520a1c3","azureResourceGroup":"aks","kubernetesCluster":"mesh","namespace":"default","command":"set","useConfigurationFile":"false","configuration":"","arguments":"image deployment/smackapi-green smackapi=pierluigi.azurecr.io/smackapi:$(imagetag)","secretType":"dockerRegistry","secretArguments":"","containerRegistryType":"Azure Container Registry","dockerRegistryEndpoint":"","azureSubscriptionEndpointForSecrets":"","azureContainerRegistry":"","secretName":"","forceUpdate":"true","configMapName":"","forceUpdateConfigMap":"false","useConfigMapFile":"false","configMapFile":"","configMapArguments":"","versionOrLocation":"version","versionSpec":"1.7.0","checkLatest":"false","specifyLocation":"","cwd":"$(System.DefaultWorkingDirectory)","outputFormat":"json"}}]}],"environmentOptions":{"emailNotificationType":"OnlyOnFailure","emailRecipients":"release.environment.owner;release.creator","skipArtifactsDownload":false,"timeoutInMinutes":0,"enableAccessToken":false,"publishDeploymentStatus":true,"badgeEnabled":false,"autoLinkWorkItems":false,"pullRequestDeploymentEnabled":false},"demands":[],"conditions":[{"name":"ReleaseStarted","conditionType":1,"value":""}],"executionPolicy":{"concurrencyCount":1,"queueDepthCount":0},"schedules":[],"currentRelease":{"id":57,"url":"https://vsrm.dev.azure.com/pierluigi-github/d28df87b-0aad-4b63-9b1e-f633021b42e2/_apis/Release/releases/57","_links":{}},"retentionPolicy":{"daysToKeep":30,"releasesToKeep":3,"retainBuild":true},"processParameters":{},"properties":{},"preDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"postDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"environmentTriggers":[],"badgeUrl":"https://vsrm.dev.azure.com/pierluigi-github/_apis/public/Release/badge/d28df87b-0aad-4b63-9b1e-f633021b42e2/1/1"},{"id":2,"name":"Helm Apply 90/10","rank":2,"owner":{"displayName":"Pierlo Upitup","url":"https://app.vssps.visualstudio.com/A98148d1e-0359-4d91-8810-1683762054ef/_apis/Identities/5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","_links":{"avatar":{"href":"https://dev.azure.com/pierluigi-github/_apis/GraphProfile/MemberAvatars/msa.NWUwZWEwYzctNzFkNy03ZWExLWExMmEtOTQ0Y2IxMzE4ZDhj"}},"id":"5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","uniqueName":"pierlooqup@gmail.com","imageUrl":"https://dev.azure.com/pierluigi-github/_api/_common/identityImage?id=5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","descriptor":"msa.NWUwZWEwYzctNzFkNy03ZWExLWExMmEtOTQ0Y2IxMzE4ZDhj"},"variables":{},"variableGroups":[],"preDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":4}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":1}},"deployStep":{"id":5},"postDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":6}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":2}},"deployPhases":[{"deploymentInput":{"parallelExecution":{"parallelExecutionType":0},"skipArtifactsDownload":false,"artifactsDownloadInput":{"downloadInputs":[]},"queueId":12,"demands":[],"enableAccessToken":false,"timeoutInMinutes":0,"jobCancelTimeoutInMinutes":1,"condition":"succeeded()","overrideInputs":{}},"rank":1,"phaseType":1,"name":"Agent job","refName":null,"workflowTasks":[{"environment":{},"taskId":"068d5909-43e6-48c5-9e01-7c8a94816220","version":"0.*","name":"Install Helm 2.11.0","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"helmVersion":"2.11.0","checkLatestHelmVersion":"false","installKubeCtl":"true","kubectlVersion":"1.10.3","checkLatestKubeCtl":"false"}},{"environment":{},"taskId":"afa7d54d-537b-4dc8-b60a-e0eeea2c9a87","version":"0.*","name":"helm upgrade","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"connectionType":"Azure Resource Manager","azureSubscriptionEndpoint":"0e835040-6b34-4c78-84b2-c2a01520a1c3","azureResourceGroup":"aks","kubernetesCluster":"mesh","kubernetesServiceEndpoint":"","namespace":"default","command":"upgrade","chartType":"Name","chartName":"_githubpartners.blueprint\\drop\\routerule-0.1.0.tgz","chartPath":"","version":"","releaseName":"api-rules","overrideValues":"prod.weight=90,dev.weight=10","valueFile":"","destination":"$(Build.ArtifactStagingDirectory)","canaryimage":"false","upgradetiller":"true","updatedependency":"false","save":"true","install":"true","recreate":"false","resetValues":"false","force":"true","waitForExecution":"true","arguments":"--reuse-values","enableTls":"false","caCert":"","certificate":"","privatekey":"","tillernamespace":""}}]}],"environmentOptions":{"emailNotificationType":"OnlyOnFailure","emailRecipients":"release.environment.owner;release.creator","skipArtifactsDownload":false,"timeoutInMinutes":0,"enableAccessToken":false,"publishDeploymentStatus":true,"badgeEnabled":false,"autoLinkWorkItems":false,"pullRequestDeploymentEnabled":false},"demands":[],"conditions":[{"name":"Inject new tag in dev","conditionType":2,"value":"4"}],"executionPolicy":{"concurrencyCount":1,"queueDepthCount":0},"schedules":[],"currentRelease":{"id":57,"url":"https://vsrm.dev.azure.com/pierluigi-github/d28df87b-0aad-4b63-9b1e-f633021b42e2/_apis/Release/releases/57","_links":{}},"retentionPolicy":{"daysToKeep":30,"releasesToKeep":3,"retainBuild":true},"processParameters":{"dataSourceBindings":[{"parameters":{},"endpointId":"$(azureSubscriptionEndpoint)","target":"kubernetesCluster","resultTemplate":"{{{name}}}","endpointUrl":"{{{endpoint.url}}}/subscriptions/{{{endpoint.subscriptionId}}}/resourceGroups/$(azureResourceGroup)/providers/Microsoft.ContainerService/managedClusters?api-version=2017-08-31","resultSelector":"jsonpath:$.value[*]"},{"parameters":{},"endpointId":"$(azureSubscriptionEndpoint)","target":"azureResourceGroup","resultTemplate":"{{{ #extractResource id resourcegroups}}}","endpointUrl":"{{{endpoint.url}}}/subscriptions/{{{endpoint.subscriptionId}}}/providers/Microsoft.ContainerService/managedClusters?api-version=2017-08-31","resultSelector":"jsonpath:$.value[*]"}]},"properties":{},"preDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"postDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"environmentTriggers":[],"badgeUrl":"https://vsrm.dev.azure.com/pierluigi-github/_apis/public/Release/badge/d28df87b-0aad-4b63-9b1e-f633021b42e2/1/2"},{"id":3,"name":"Helm Apply 10/90","rank":3,"owner":{"displayName":"Pierlo Upitup","url":"https://app.vssps.visualstudio.com/A98148d1e-0359-4d91-8810-1683762054ef/_apis/Identities/5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","_links":{"avatar":{"href":"https://dev.azure.com/pierluigi-github/_apis/GraphProfile/MemberAvatars/msa.NWUwZWEwYzctNzFkNy03ZWExLWExMmEtOTQ0Y2IxMzE4ZDhj"}},"id":"5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","uniqueName":"pierlooqup@gmail.com","imageUrl":"https://dev.azure.com/pierluigi-github/_api/_common/identityImage?id=5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","descriptor":"msa.NWUwZWEwYzctNzFkNy03ZWExLWExMmEtOTQ0Y2IxMzE4ZDhj"},"variables":{},"variableGroups":[],"preDeployApprovals":{"approvals":[{"rank":1,"isAutomated":false,"isNotificationOn":false,"approver":{"displayName":"Pierlo Upitup","url":"https://app.vssps.visualstudio.com/A98148d1e-0359-4d91-8810-1683762054ef/_apis/Identities/5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","_links":{"avatar":{"href":"https://dev.azure.com/pierluigi-github/_apis/GraphProfile/MemberAvatars/msa.NWUwZWEwYzctNzFkNy03ZWExLWExMmEtOTQ0Y2IxMzE4ZDhj"}},"id":"5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","uniqueName":"pierlooqup@gmail.com","imageUrl":"https://dev.azure.com/pierluigi-github/_api/_common/identityImage?id=5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","descriptor":"msa.NWUwZWEwYzctNzFkNy03ZWExLWExMmEtOTQ0Y2IxMzE4ZDhj"},"id":16}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":true,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":1}},"deployStep":{"id":8},"postDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":9}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":2}},"deployPhases":[{"deploymentInput":{"parallelExecution":{"parallelExecutionType":0},"skipArtifactsDownload":false,"artifactsDownloadInput":{"downloadInputs":[]},"queueId":12,"demands":[],"enableAccessToken":false,"timeoutInMinutes":0,"jobCancelTimeoutInMinutes":1,"condition":"succeeded()","overrideInputs":{}},"rank":1,"phaseType":1,"name":"Agent job","refName":null,"workflowTasks":[{"environment":{},"taskId":"068d5909-43e6-48c5-9e01-7c8a94816220","version":"0.*","name":"Install Helm 2.11.0","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"helmVersion":"2.11.0","checkLatestHelmVersion":"false","installKubeCtl":"true","kubectlVersion":"1.10.3","checkLatestKubeCtl":"false"}},{"environment":{},"taskId":"afa7d54d-537b-4dc8-b60a-e0eeea2c9a87","version":"0.*","name":"helm upgrade","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"connectionType":"Azure Resource Manager","azureSubscriptionEndpoint":"0e835040-6b34-4c78-84b2-c2a01520a1c3","azureResourceGroup":"aks","kubernetesCluster":"mesh","kubernetesServiceEndpoint":"","namespace":"default","command":"upgrade","chartType":"Name","chartName":"_githubpartners.blueprint\\drop\\routerule-0.1.0.tgz","chartPath":"","version":"","releaseName":"api-rules","overrideValues":"prod.weight=10,dev.weight=90","valueFile":"","destination":"$(Build.ArtifactStagingDirectory)","canaryimage":"false","upgradetiller":"true","updatedependency":"false","save":"true","install":"true","recreate":"false","resetValues":"false","force":"true","waitForExecution":"true","arguments":"--reuse-values","enableTls":"false","caCert":"","certificate":"","privatekey":"","tillernamespace":""}}]}],"environmentOptions":{"emailNotificationType":"OnlyOnFailure","emailRecipients":"release.environment.owner;release.creator","skipArtifactsDownload":false,"timeoutInMinutes":0,"enableAccessToken":false,"publishDeploymentStatus":true,"badgeEnabled":false,"autoLinkWorkItems":false,"pullRequestDeploymentEnabled":false},"demands":[],"conditions":[{"name":"Helm Apply 90/10","conditionType":2,"value":"4"}],"executionPolicy":{"concurrencyCount":1,"queueDepthCount":0},"schedules":[],"currentRelease":{"id":57,"url":"https://vsrm.dev.azure.com/pierluigi-github/d28df87b-0aad-4b63-9b1e-f633021b42e2/_apis/Release/releases/57","_links":{}},"retentionPolicy":{"daysToKeep":30,"releasesToKeep":3,"retainBuild":true},"processParameters":{"dataSourceBindings":[{"parameters":{},"endpointId":"$(azureSubscriptionEndpoint)","target":"kubernetesCluster","resultTemplate":"{{{name}}}","endpointUrl":"{{{endpoint.url}}}/subscriptions/{{{endpoint.subscriptionId}}}/resourceGroups/$(azureResourceGroup)/providers/Microsoft.ContainerService/managedClusters?api-version=2017-08-31","resultSelector":"jsonpath:$.value[*]"},{"parameters":{},"endpointId":"$(azureSubscriptionEndpoint)","target":"azureResourceGroup","resultTemplate":"{{{ #extractResource id resourcegroups}}}","endpointUrl":"{{{endpoint.url}}}/subscriptions/{{{endpoint.subscriptionId}}}/providers/Microsoft.ContainerService/managedClusters?api-version=2017-08-31","resultSelector":"jsonpath:$.value[*]"}]},"properties":{},"preDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"postDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"environmentTriggers":[],"badgeUrl":"https://vsrm.dev.azure.com/pierluigi-github/_apis/public/Release/badge/d28df87b-0aad-4b63-9b1e-f633021b42e2/1/3"},{"id":4,"name":"Inject new tag in prod","rank":4,"owner":{"displayName":"Pierlo Upitup","url":"https://app.vssps.visualstudio.com/A98148d1e-0359-4d91-8810-1683762054ef/_apis/Identities/5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","_links":{"avatar":{"href":"https://dev.azure.com/pierluigi-github/_apis/GraphProfile/MemberAvatars/msa.NWUwZWEwYzctNzFkNy03ZWExLWExMmEtOTQ0Y2IxMzE4ZDhj"}},"id":"5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","uniqueName":"pierlooqup@gmail.com","imageUrl":"https://dev.azure.com/pierluigi-github/_api/_common/identityImage?id=5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","descriptor":"msa.NWUwZWEwYzctNzFkNy03ZWExLWExMmEtOTQ0Y2IxMzE4ZDhj"},"variables":{},"variableGroups":[],"preDeployApprovals":{"approvals":[{"rank":1,"isAutomated":false,"isNotificationOn":false,"approver":{"displayName":"Pierlo Upitup","url":"https://app.vssps.visualstudio.com/A98148d1e-0359-4d91-8810-1683762054ef/_apis/Identities/5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","_links":{"avatar":{"href":"https://dev.azure.com/pierluigi-github/_apis/GraphProfile/MemberAvatars/msa.NWUwZWEwYzctNzFkNy03ZWExLWExMmEtOTQ0Y2IxMzE4ZDhj"}},"id":"5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","uniqueName":"pierlooqup@gmail.com","imageUrl":"https://dev.azure.com/pierluigi-github/_api/_common/identityImage?id=5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","descriptor":"msa.NWUwZWEwYzctNzFkNy03ZWExLWExMmEtOTQ0Y2IxMzE4ZDhj"},"id":17}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":true,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":1}},"deployStep":{"id":11},"postDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":12}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":2}},"deployPhases":[{"deploymentInput":{"parallelExecution":{"parallelExecutionType":0},"skipArtifactsDownload":false,"artifactsDownloadInput":{"downloadInputs":[]},"queueId":12,"demands":[],"enableAccessToken":false,"timeoutInMinutes":0,"jobCancelTimeoutInMinutes":1,"condition":"succeeded()","overrideInputs":{}},"rank":1,"phaseType":1,"name":"Agent job","refName":null,"workflowTasks":[{"environment":{},"taskId":"e213ff0f-5d5c-4791-802d-52ea3e7be1f1","version":"2.*","name":"export var","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"$imagetag = Get-Content -Path  _githubpartners.blueprint\\drop\\imagetag\n\nWrite-Output(\"##vso[task.setvariable variable=imagetag;]$imagetag\")","errorActionPreference":"stop","failOnStderr":"false","ignoreLASTEXITCODE":"false","pwsh":"false","workingDirectory":""}},{"environment":{},"taskId":"cbc316a2-586f-4def-be79-488a1f503564","version":"1.*","name":"kubectl set","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"connectionType":"Azure Resource Manager","kubernetesServiceEndpoint":"","azureSubscriptionEndpoint":"0e835040-6b34-4c78-84b2-c2a01520a1c3","azureResourceGroup":"aks","kubernetesCluster":"mesh","namespace":"default","command":"set","useConfigurationFile":"false","configuration":"","arguments":"image deployment/smackapi-blue smackapi=pierluigi.azurecr.io/smackapi:$(imagetag)","secretType":"dockerRegistry","secretArguments":"","containerRegistryType":"Azure Container Registry","dockerRegistryEndpoint":"","azureSubscriptionEndpointForSecrets":"","azureContainerRegistry":"","secretName":"","forceUpdate":"true","configMapName":"","forceUpdateConfigMap":"false","useConfigMapFile":"false","configMapFile":"","configMapArguments":"","versionOrLocation":"version","versionSpec":"1.7.0","checkLatest":"false","specifyLocation":"","cwd":"$(System.DefaultWorkingDirectory)","outputFormat":"json"}}]}],"environmentOptions":{"emailNotificationType":"OnlyOnFailure","emailRecipients":"release.environment.owner;release.creator","skipArtifactsDownload":false,"timeoutInMinutes":0,"enableAccessToken":false,"publishDeploymentStatus":true,"badgeEnabled":false,"autoLinkWorkItems":false,"pullRequestDeploymentEnabled":false},"demands":[],"conditions":[{"name":"Helm Apply 10/90","conditionType":2,"value":"4"}],"executionPolicy":{"concurrencyCount":1,"queueDepthCount":0},"schedules":[],"currentRelease":{"id":57,"url":"https://vsrm.dev.azure.com/pierluigi-github/d28df87b-0aad-4b63-9b1e-f633021b42e2/_apis/Release/releases/57","_links":{}},"retentionPolicy":{"daysToKeep":30,"releasesToKeep":3,"retainBuild":true},"processParameters":{},"properties":{},"preDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"postDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"environmentTriggers":[],"badgeUrl":"https://vsrm.dev.azure.com/pierluigi-github/_apis/public/Release/badge/d28df87b-0aad-4b63-9b1e-f633021b42e2/1/4"},{"id":5,"name":"helm prod to 100","rank":5,"owner":{"displayName":"Pierlo Upitup","url":"https://app.vssps.visualstudio.com/A98148d1e-0359-4d91-8810-1683762054ef/_apis/Identities/5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","_links":{"avatar":{"href":"https://dev.azure.com/pierluigi-github/_apis/GraphProfile/MemberAvatars/msa.NWUwZWEwYzctNzFkNy03ZWExLWExMmEtOTQ0Y2IxMzE4ZDhj"}},"id":"5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","uniqueName":"pierlooqup@gmail.com","imageUrl":"https://dev.azure.com/pierluigi-github/_api/_common/identityImage?id=5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","descriptor":"msa.NWUwZWEwYzctNzFkNy03ZWExLWExMmEtOTQ0Y2IxMzE4ZDhj"},"variables":{},"variableGroups":[],"preDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":13}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":1}},"deployStep":{"id":14},"postDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":15}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":2}},"deployPhases":[{"deploymentInput":{"parallelExecution":{"parallelExecutionType":0},"skipArtifactsDownload":false,"artifactsDownloadInput":{"downloadInputs":[]},"queueId":12,"demands":[],"enableAccessToken":false,"timeoutInMinutes":0,"jobCancelTimeoutInMinutes":1,"condition":"succeeded()","overrideInputs":{}},"rank":1,"phaseType":1,"name":"Agent job","refName":null,"workflowTasks":[{"environment":{},"taskId":"068d5909-43e6-48c5-9e01-7c8a94816220","version":"0.*","name":"Install Helm 2.11.0","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"helmVersion":"2.11.0","checkLatestHelmVersion":"false","installKubeCtl":"true","kubectlVersion":"1.10.3","checkLatestKubeCtl":"false"}},{"environment":{},"taskId":"afa7d54d-537b-4dc8-b60a-e0eeea2c9a87","version":"0.*","name":"helm upgrade","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"connectionType":"Azure Resource Manager","azureSubscriptionEndpoint":"0e835040-6b34-4c78-84b2-c2a01520a1c3","azureResourceGroup":"aks","kubernetesCluster":"mesh","kubernetesServiceEndpoint":"","namespace":"default","command":"upgrade","chartType":"Name","chartName":"_githubpartners.blueprint\\drop\\routerule-0.1.0.tgz","chartPath":"","version":"","releaseName":"api-rules","overrideValues":"prod.weight=100,dev.weight=0","valueFile":"","destination":"$(Build.ArtifactStagingDirectory)","canaryimage":"false","upgradetiller":"true","updatedependency":"false","save":"true","install":"true","recreate":"false","resetValues":"false","force":"true","waitForExecution":"true","arguments":"--reuse-values","enableTls":"false","caCert":"","certificate":"","privatekey":"","tillernamespace":""}}]}],"environmentOptions":{"emailNotificationType":"OnlyOnFailure","emailRecipients":"release.environment.owner;release.creator","skipArtifactsDownload":false,"timeoutInMinutes":0,"enableAccessToken":false,"publishDeploymentStatus":true,"badgeEnabled":false,"autoLinkWorkItems":false,"pullRequestDeploymentEnabled":false},"demands":[],"conditions":[{"name":"Inject new tag in prod","conditionType":2,"value":"4"}],"executionPolicy":{"concurrencyCount":1,"queueDepthCount":0},"schedules":[],"currentRelease":{"id":57,"url":"https://vsrm.dev.azure.com/pierluigi-github/d28df87b-0aad-4b63-9b1e-f633021b42e2/_apis/Release/releases/57","_links":{}},"retentionPolicy":{"daysToKeep":30,"releasesToKeep":3,"retainBuild":true},"processParameters":{"dataSourceBindings":[{"parameters":{},"endpointId":"$(azureSubscriptionEndpoint)","target":"kubernetesCluster","resultTemplate":"{{{name}}}","endpointUrl":"{{{endpoint.url}}}/subscriptions/{{{endpoint.subscriptionId}}}/resourceGroups/$(azureResourceGroup)/providers/Microsoft.ContainerService/managedClusters?api-version=2017-08-31","resultSelector":"jsonpath:$.value[*]"},{"parameters":{},"endpointId":"$(azureSubscriptionEndpoint)","target":"azureResourceGroup","resultTemplate":"{{{ #extractResource id resourcegroups}}}","endpointUrl":"{{{endpoint.url}}}/subscriptions/{{{endpoint.subscriptionId}}}/providers/Microsoft.ContainerService/managedClusters?api-version=2017-08-31","resultSelector":"jsonpath:$.value[*]"}]},"properties":{},"preDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"postDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"environmentTriggers":[],"badgeUrl":"https://vsrm.dev.azure.com/pierluigi-github/_apis/public/Release/badge/d28df87b-0aad-4b63-9b1e-f633021b42e2/1/5"},{"id":6,"name":"WEB Inject new tag in prod","rank":6,"owner":{"displayName":"Pierlo Upitup","url":"https://app.vssps.visualstudio.com/A98148d1e-0359-4d91-8810-1683762054ef/_apis/Identities/5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","_links":{"avatar":{"href":"https://dev.azure.com/pierluigi-github/_apis/GraphProfile/MemberAvatars/msa.NWUwZWEwYzctNzFkNy03ZWExLWExMmEtOTQ0Y2IxMzE4ZDhj"}},"id":"5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","uniqueName":"pierlooqup@gmail.com","imageUrl":"https://dev.azure.com/pierluigi-github/_api/_common/identityImage?id=5e0ea0c7-71d7-6ea1-a12a-944cb1318d8c","descriptor":"msa.NWUwZWEwYzctNzFkNy03ZWExLWExMmEtOTQ0Y2IxMzE4ZDhj"},"variables":{},"variableGroups":[],"preDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":18}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":1}},"deployStep":{"id":19},"postDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":20}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":2}},"deployPhases":[{"deploymentInput":{"parallelExecution":{"parallelExecutionType":0},"skipArtifactsDownload":false,"artifactsDownloadInput":{"downloadInputs":[]},"queueId":12,"demands":[],"enableAccessToken":false,"timeoutInMinutes":0,"jobCancelTimeoutInMinutes":1,"condition":"succeeded()","overrideInputs":{}},"rank":1,"phaseType":1,"name":"Agent job","refName":null,"workflowTasks":[{"environment":{},"taskId":"e213ff0f-5d5c-4791-802d-52ea3e7be1f1","version":"2.*","name":"export var","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"$webimagetag = Get-Content -Path  _githubpartners.blueprint\\drop\\imagetag\n\nWrite-Output(\"##vso[task.setvariable variable=webimagetag;]$webimagetag\")","errorActionPreference":"stop","failOnStderr":"false","ignoreLASTEXITCODE":"false","pwsh":"false","workingDirectory":""}},{"environment":{},"taskId":"cbc316a2-586f-4def-be79-488a1f503564","version":"1.*","name":"kubectl set","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"connectionType":"Azure Resource Manager","kubernetesServiceEndpoint":"","azureSubscriptionEndpoint":"0e835040-6b34-4c78-84b2-c2a01520a1c3","azureResourceGroup":"aks","kubernetesCluster":"mesh","namespace":"default","command":"set","useConfigurationFile":"false","configuration":"","arguments":"image deployment/smackweb smackweb=pierluigi.azurecr.io/smackweb:$(webimagetag)","secretType":"dockerRegistry","secretArguments":"","containerRegistryType":"Azure Container Registry","dockerRegistryEndpoint":"","azureSubscriptionEndpointForSecrets":"","azureContainerRegistry":"","secretName":"","forceUpdate":"true","configMapName":"","forceUpdateConfigMap":"false","useConfigMapFile":"false","configMapFile":"","configMapArguments":"","versionOrLocation":"version","versionSpec":"1.7.0","checkLatest":"false","specifyLocation":"","cwd":"$(System.DefaultWorkingDirectory)","outputFormat":"json"}}]}],"environmentOptions":{"emailNotificationType":"OnlyOnFailure","emailRecipients":"release.environment.owner;release.creator","skipArtifactsDownload":false,"timeoutInMinutes":0,"enableAccessToken":false,"publishDeploymentStatus":true,"badgeEnabled":false,"autoLinkWorkItems":false,"pullRequestDeploymentEnabled":false},"demands":[],"conditions":[{"name":"ReleaseStarted","conditionType":1,"value":""}],"executionPolicy":{"concurrencyCount":1,"queueDepthCount":0},"schedules":[],"currentRelease":{"id":57,"url":"https://vsrm.dev.azure.com/pierluigi-github/d28df87b-0aad-4b63-9b1e-f633021b42e2/_apis/Release/releases/57","_links":{}},"retentionPolicy":{"daysToKeep":30,"releasesToKeep":3,"retainBuild":true},"processParameters":{},"properties":{},"preDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"postDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"environmentTriggers":[],"badgeUrl":"https://vsrm.dev.azure.com/pierluigi-github/_apis/public/Release/badge/d28df87b-0aad-4b63-9b1e-f633021b42e2/1/6"}],"artifacts":[{"sourceId":"d28df87b-0aad-4b63-9b1e-f633021b42e2:3","type":"Build","alias":"_githubpartners.blueprint","definitionReference":{"artifactSourceDefinitionUrl":{"id":"https://dev.azure.com/pierluigi-github/_permalink/_build/index?collectionId=a7be7219-e015-4b02-b72e-aa7bcdf26e75&projectId=d28df87b-0aad-4b63-9b1e-f633021b42e2&definitionId=3","name":""},"defaultVersionBranch":{"id":"","name":""},"defaultVersionSpecific":{"id":"","name":""},"defaultVersionTags":{"id":"","name":""},"defaultVersionType":{"id":"selectDuringReleaseCreationType","name":"Specify at the time of release creation"},"definition":{"id":"3","name":"githubpartners.github-azure-microservices-blueprint"},"definitions":{"id":"","name":""},"IsMultiDefinitionType":{"id":"False","name":"False"},"project":{"id":"d28df87b-0aad-4b63-9b1e-f633021b42e2","name":"github-azure-microservices-blueprint"},"repository":{"id":"a6f64f63-167a-4790-adc7-2936898ddcd4","name":"github-azure-microservices-blueprint"}},"isPrimary":true,"isRetained":false}],"triggers":[{"artifactAlias":"_githubpartners.blueprint","triggerConditions":[],"triggerType":1}],"releaseNameFormat":"Release-$(rev:r)","tags":[],"pipelineProcess":{"type":1},"properties":{"DefinitionCreationSource":{"$type":"System.String","$value":"Other"}},"id":1,"name":"Blue/Green","path":"\\","projectReference":null,"url":"https://vsrm.dev.azure.com/pierluigi-github/d28df87b-0aad-4b63-9b1e-f633021b42e2/_apis/Release/definitions/1","_links":{"self":{"href":"https://vsrm.dev.azure.com/pierluigi-github/d28df87b-0aad-4b63-9b1e-f633021b42e2/_apis/Release/definitions/1"},"web":{"href":"https://dev.azure.com/pierluigi-github/d28df87b-0aad-4b63-9b1e-f633021b42e2/_release?definitionId=1"}}}